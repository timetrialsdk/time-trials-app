<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>Time Trials</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body { font-family:'Orbitron',sans-serif; background:#000; color:#ffb300; overflow-x:hidden; }

/* ORANGE SPEED LINES */
body::before{
  content:"";
  position:fixed;
  inset:-100% -100% -100% -100%;
  background:repeating-linear-gradient(135deg,
    rgba(255,150,0,0.32) 0px,
    rgba(255,150,0,0.32) 16px,
    transparent 16px,
    transparent 320px);
  pointer-events:none;
  z-index:1;
}

/* FLAGS */
.flag{
  position:fixed;
  width:180px;
  height:130px;
  background-size:36px 36px;
  background-image:
    linear-gradient(45deg,#000 25%,transparent 25%),
    linear-gradient(-45deg,#000 25%,transparent 25%),
    linear-gradient(45deg,transparent 75%,#000 75%),
    linear-gradient(-45deg,transparent 75%,#000 75%);
  background-position:0 0,0 18px,18px -18px,-18px 0px;
  background-color:#fff;
  z-index:1;
}
.flag-left{top:140px;left:40px;transform:rotate(-18deg);}
.flag-right{bottom:40px;right:40px;transform:rotate(12deg);}

#home,.route-page{position:relative;z-index:2;}

button{
  padding:8px 14px;
  background:#111;
  color:#ffb300;
  border:1px solid #ffb300;
  border-radius:6px;
  cursor:pointer;
  transition:transform .15s,box-shadow .15s;
}
button:hover{transform:scale(1.08);box-shadow:0 0 12px rgba(255,180,0,.7);}

.menu-box{
  max-width:380px;
  margin:20px auto;
  background:#111;
  padding:20px;
  border-radius:12px;
  box-shadow:0 0 25px rgba(0,0,0,.7);
  text-align:center;
}

.menu-row{display:flex;gap:10px;justify-content:center;margin-bottom:12px;}

.route-card{
  background:#111;
  padding:15px;
  border-radius:8px;
  width:260px;
  cursor:pointer;
  box-shadow:0 0 15px rgba(0,0,0,.6);
}

.route-page{
  position:fixed;
  inset:0;
  display:none;
  padding:30px;
  z-index:1000;
}

.route-container{
  max-width:900px;
  margin:auto;
  background:#111;
  padding:25px;
  border-radius:12px;
  box-shadow:0 0 30px rgba(0,0,0,.7);
}

/* SNAKE BOX */
.game-box{
  width:320px;
  height:320px;
  margin:20px auto;
  border:2px solid #ffb300;
  display:flex;
  justify-content:center;
  align-items:center;
  box-shadow:0 0 20px rgba(255,180,0,.6);
}

canvas{background:#000;}

</style>
</head>

<body>

<div class="flag flag-left"></div>
<div class="flag flag-right"></div>

<div id="home">
  <h1 style="text-align:center;font-size:60px;">TIME TRIALS</h1>
  <div style="text-align:center;font-size:20px;margin-top:-10px;">
    hvis ikke du ryster, var det ikke hurtigt nok
  </div>

  <div class="menu-box">
    <div class="menu-row">
      <input id="newRouteName" placeholder="Navn p√• rute">
      <button onclick="addRoute()">Tilf√∏j rute</button>
    </div>

    <div class="menu-row">
      <button onclick="openLeaderboard()">üèÜ Leaderboard</button>
      <button onclick="openGames()">üéÆ Games</button>
    </div>
  </div>

  <h2 style="text-align:center;color:red;">RUNS</h2>
  <div id="routes" style="display:flex;gap:20px;justify-content:center;flex-wrap:wrap;"></div>
</div>

<div class="route-page" id="gamesPage"></div>

<script>
/* ---- SNAKE ---- */
let snakeInterval=null;
let snakeKeyHandler=null;

function openGames(){
  home.style.display="none";
  gamesPage.style.display="block";

  gamesPage.innerHTML=`
    <div class="route-container">
      <button onclick="closeGames()">‚Üê Tilbage</button>
      <h2 style="text-align:center;">SNAKE</h2>

      <div class="game-box">
        <canvas id="snake" width="300" height="300"></canvas>
      </div>

      <p style="text-align:center;">Brug piletaster ‚Äì Tryk SPACE for at starte</p>
    </div>`;

  startSnake();
}

function closeGames(){
  if(snakeInterval) clearInterval(snakeInterval);
  if(snakeKeyHandler) document.removeEventListener("keydown",snakeKeyHandler);
  gamesPage.style.display="none";
  home.style.display="block";
}

function startSnake(){
  const canvas=document.getElementById("snake");
  const ctx=canvas.getContext("2d");
  const box=15;

  let snake=[{x:9*box,y:9*box}];
  let direction="RIGHT";
  let nextDirection="RIGHT";
  let running=false;

  let food={x:5*box,y:5*box};

  snakeKeyHandler=e=>{
    if(e.code==="Space"){running=true;return;}

    if(e.key==="ArrowUp"&&direction!=="DOWN")nextDirection="UP";
    if(e.key==="ArrowDown"&&direction!=="UP")nextDirection="DOWN";
    if(e.key==="ArrowLeft"&&direction!=="RIGHT")nextDirection="LEFT";
    if(e.key==="ArrowRight"&&direction!=="LEFT")nextDirection="RIGHT";
  };

  document.addEventListener("keydown",snakeKeyHandler);

  function draw(){
    ctx.clearRect(0,0,300,300);

    if(!running){
      ctx.fillStyle="#ffb300";
      ctx.font="16px Orbitron";
      ctx.textAlign="center";
      ctx.fillText("Tryk SPACE for at starte",150,150);
      return;
    }

    direction=nextDirection;

    for(let p of snake){
      ctx.fillStyle="#ffb300";
      ctx.fillRect(p.x,p.y,box,box);
    }

    ctx.fillStyle="red";
    ctx.fillRect(food.x,food.y,box,box);

    let head={x:snake[0].x,y:snake[0].y};

    if(direction==="UP")head.y-=box;
    if(direction==="DOWN")head.y+=box;
    if(direction==="LEFT")head.x-=box;
    if(direction==="RIGHT")head.x+=box;

    if(head.x<0||head.y<0||head.x>=300||head.y>=300||
       snake.some(p=>p.x===head.x&&p.y===head.y)){
      snake=[{x:9*box,y:9*box}];
      running=false;
      direction="RIGHT";
      nextDirection="RIGHT";
      return;
    }

    if(head.x===food.x&&head.y===food.y){
      food={x:Math.floor(Math.random()*19)*box,y:Math.floor(Math.random()*19)*box};
    }else{
      snake.pop();
    }

    snake.unshift(head);
  }

  snakeInterval=setInterval(draw,120);
}
</script>

</body>
</html>
