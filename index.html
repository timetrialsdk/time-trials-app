<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>Time Trials</title>

<style>
body{
  background:#111;
  color:white;
  font-family:Arial;
  padding:20px;
}
button{
  padding:10px;
  margin:5px 0;
}
input{
  display:block;
  width:260px;
  padding:10px;
  margin:5px 0;
}
.route, .run{
  background:#222;
  padding:8px;
  margin:6px 0;
}
</style>
</head>
<body>

<h1 style="color:gold">TIME TRIALS</h1>
<p>hvis du ikke ryster, var det ikke hurtigt nok</p>

<hr>

<!-- ROUTES -->
<div id="routesView">
  <button id="addRoute">âž• TilfÃ¸j rute</button>
  <div id="routes"></div>
</div>

<!-- ROUTE PAGE -->
<div id="routeView" style="display:none">
  <button id="back">â¬… Tilbage</button>
  <h2 id="routeTitle"></h2>

  <h3>TilfÃ¸j run</h3>
  <input id="name" placeholder="Navn">
  <input id="time" placeholder="Tid (mm:ss)">
  <input id="video" placeholder="Video-link">
  <button id="addRun">TilfÃ¸j run</button>

  <h3>Tider</h3>
  <div id="runs"></div>
</div>

<script>
/* ---------- STORAGE ---------- */
const STORAGE_KEY = "time_trials_routes";

function saveRoutes(){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(routes));
}

function loadRoutes(){
  const data = localStorage.getItem(STORAGE_KEY);
  return data ? JSON.parse(data) : [];
}

/* ---------- STATE ---------- */
let routes = loadRoutes();
let currentRouteIndex = null;

/* ---------- ELEMENTS ---------- */
const routesView = document.getElementById("routesView");
const routeView = document.getElementById("routeView");
const routesDiv = document.getElementById("routes");
const runsDiv = document.getElementById("runs");

/* ---------- ADD ROUTE ---------- */
document.getElementById("addRoute").onclick = () => {
  routes.push({ name: "Ny rute", runs: [] });
  saveRoutes();
  renderRoutes();
};

/* ---------- RENDER ROUTES ---------- */
function renderRoutes(){
  routesDiv.innerHTML = "";
  routes.forEach((r, i) => {
    const d = document.createElement("div");
    d.className = "route";
    d.innerHTML = `<b>${r.name}</b>`;
    const btn = document.createElement("button");
    btn.textContent = "Ã…bn";
    btn.onclick = () => openRoute(i);
    d.appendChild(document.createElement("br"));
    d.appendChild(btn);
    routesDiv.appendChild(d);
  });
}

/* ---------- OPEN ROUTE ---------- */
function openRoute(index){
  currentRouteIndex = index;
  document.getElementById("routeTitle").textContent = routes[index].name;
  routesView.style.display = "none";
  routeView.style.display = "block";
  renderRuns();
}

/* ---------- BACK ---------- */
document.getElementById("back").onclick = () => {
  routeView.style.display = "none";
  routesView.style.display = "block";
  renderRoutes();
};

/* ---------- ADD RUN ---------- */
document.getElementById("addRun").onclick = () => {
  const name = document.getElementById("name").value;
  const time = document.getElementById("time").value;
  const video = document.getElementById("video").value;

  if(!name || !time){
    alert("Udfyld navn og tid");
    return;
  }

  routes[currentRouteIndex].runs.push({ name, time, video });
  saveRoutes();

  document.getElementById("name").value = "";
  document.getElementById("time").value = "";
  document.getElementById("video").value = "";

  renderRuns();
};

/* ---------- RENDER RUNS ---------- */
function renderRuns(){
  runsDiv.innerHTML = "";
  routes[currentRouteIndex].runs.forEach(r => {
    const d = document.createElement("div");
    d.className = "run";
    d.innerHTML = `<b>${r.name}</b> â€“ ${r.time} ${r.video ? "ðŸŽ¥" : ""}`;
    runsDiv.appendChild(d);
  });
}

/* ---------- INIT ---------- */
renderRoutes();
</script>

</body>
</html>
